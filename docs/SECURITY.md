# セキュリティポリシー

## 概要
サポートドックは障害福祉事業所の支援記録作成システムとして、利用者の個人情報を適切に保護することを最優先事項とします。

## 個人情報保護方針

### 1. 取り扱う個人情報
- 利用者の氏名、年齢、障害名
- 音声記録（面談内容）
- アセスメント結果
- 個別支援計画書
- 支援記録

### 2. 個人情報の利用目的
- 障害福祉サービスの提供・支援計画作成
- 法定書類の作成・管理
- サービス向上のための分析（個人特定不可の統計データのみ）

### 3. 個人情報の保護措置

#### 技術的安全管理措置
- **API キー管理**: 環境変数による機密情報の分離
- **通信暗号化**: HTTPS通信の強制
- **アクセス制御**: 認証システムによる利用者制限
- **データ暗号化**: 保存データの暗号化

#### 物理的安全管理措置
- **アクセス制限**: サーバー室への入退室管理
- **機器管理**: ハードウェアの適切な廃棄・移転管理

#### 人的安全管理措置
- **教育研修**: 職員への個人情報保護教育の実施
- **アクセス権限管理**: 最小権限の原則に基づく権限付与

### 4. データ保存・削除ポリシー

#### 音声ファイル
- **保存期間**: アップロード後24時間で自動削除
- **保存場所**: サーバーローカルディスク（/uploads）
- **削除方法**: cron等による自動削除

#### アセスメントデータ
- **保存期間**: 法定保存期間に準拠（5年間）
- **保存場所**: 暗号化データベース
- **バックアップ**: 定期的なバックアップ実施

#### 生成PDF
- **保存期間**: 利用者の同意に基づく期間
- **アクセス制御**: 担当職員のみアクセス可能

## セキュリティ設定

### 環境変数管理
```bash
# 必須環境変数
OPENAI_API_KEY=sk-xxx...          # OpenAI API キー
ANTHROPIC_API_KEY=sk-ant-xxx...   # Anthropic API キー
JWT_SECRET=your-jwt-secret        # JWT署名用秘密鍵
DB_PASSWORD=secure-password       # データベースパスワード

# セキュリティ設定
NODE_ENV=production               # 本番環境設定
CORS_ORIGIN=https://yourdomain.com # CORS許可オリジン
RATE_LIMIT=100                   # API レート制限（リクエスト/時間）
```

### APIセキュリティ設定

#### Rate Limiting（レート制限）
```javascript
// 1時間あたり100リクエストに制限
const rateLimit = require('express-rate-limit');
const limiter = rateLimit({
  windowMs: 60 * 60 * 1000, // 1時間
  max: 100, // 最大100リクエスト
  message: 'Too many requests, please try again later.'
});
```

#### CORS設定
```javascript
// 特定オリジンのみ許可
const cors = require('cors');
app.use(cors({
  origin: process.env.CORS_ORIGIN || 'http://localhost:3000',
  credentials: true
}));
```

#### ヘルメット設定
```javascript
// セキュリティヘッダーの設定
const helmet = require('helmet');
app.use(helmet({
  contentSecurityPolicy: {
    directives: {
      defaultSrc: ["'self'"],
      scriptSrc: ["'self'", "'unsafe-inline'"],
      styleSrc: ["'self'", "'unsafe-inline'"]
    }
  }
}));
```

## インシデント対応

### セキュリティインシデント発生時の対応フロー

1. **即座の対応**
   - サービス停止の検討
   - 影響範囲の特定
   - 関係者への緊急連絡

2. **調査・分析**
   - ログ分析
   - 被害状況の確認
   - 原因の特定

3. **復旧・改善**
   - システム復旧
   - セキュリティ強化
   - 再発防止策の実施

4. **報告・通知**
   - 監督官庁への報告
   - 利用者への通知
   - 事後対応の実施

### 連絡先
- **システム管理者**: [admin@example.com]
- **個人情報保護責任者**: [privacy@example.com]
- **緊急時連絡先**: [emergency@example.com]

## 監査・点検

### 定期点検項目
- [ ] APIキーの定期更新（3ヶ月ごと）
- [ ] アクセスログの分析（月次）
- [ ] 脆弱性スキャンの実施（月次）
- [ ] バックアップデータの整合性確認（週次）
- [ ] 不要ファイルの削除確認（日次）

### 監査ログ
- ユーザーアクセス記録
- ファイルアップロード記録
- PDF生成記録
- エラー発生記録
- システム設定変更記録

## 第三者サービス利用

### OpenAI API
- **利用目的**: 音声認識（Whisper）
- **データ処理**: 音声ファイルのテキスト変換
- **データ保持**: OpenAI側では30日間（2024年3月時点）
- **プライバシー**: OpenAI利用規約に準拠

### Anthropic API
- **利用目的**: AI分析（Claude）
- **データ処理**: テキストの構造化分析
- **データ保持**: Anthropic側では保持なし（2024年3月時点）
- **プライバシー**: Anthropic利用規約に準拠

## 法的要件

### 準拠法規
- 個人情報保護法
- 障害者総合支援法
- 社会福祉法
- 各自治体の条例

### 書類保存義務
- 個別支援計画書: 5年間
- サービス提供記録: 5年間
- 面談記録: 5年間

## 更新履歴
- 2024年6月27日: 初版作成
- [今後の更新日程]

---

**重要**: このセキュリティポリシーは定期的に見直しを行い、法令改正やシステム更新に応じて適切に更新します。