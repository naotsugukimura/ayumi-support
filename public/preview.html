<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ­©ã¿ã‚µãƒãƒ¼ãƒˆ - å¸³ç¥¨ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans JP', sans-serif;
            background: #f8f9fa;
            color: #333;
            font-size: 18px; /* 40ä»£å‘ã‘ã«å¤§ãã */
            line-height: 1.7;
        }

        .header {
            background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 50%, #fecfef 100%);
            color: #444;
            padding: 1rem 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 1.8rem;
            font-weight: 700;
        }

        .nav-links {
            display: flex;
            gap: 2rem;
            align-items: center;
        }

        .nav-link {
            color: #444;
            text-decoration: none;
            font-weight: 500;
            font-size: 18px;
            transition: opacity 0.3s;
        }

        .nav-link:hover {
            opacity: 0.7;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }

        .page-title {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            color: #2c3e50;
            text-align: center;
        }

        .page-subtitle {
            font-size: 1.2rem;
            color: #666;
            margin-bottom: 2rem;
            text-align: center;
        }

        /* ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ„ãƒ¼ãƒ«ãƒãƒ¼ */
        .preview-toolbar {
            background: white;
            padding: 1rem;
            border-radius: 15px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .document-selector {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .document-select {
            padding: 0.8rem 1.2rem;
            border: 2px solid #ddd;
            border-radius: 25px;
            font-size: 16px;
            background: white;
            cursor: pointer;
            min-width: 200px;
        }

        .document-select:focus {
            outline: none;
            border-color: #67b279;
        }

        .toolbar-actions {
            display: flex;
            gap: 1rem;
        }

        .btn {
            background: #67b279;
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: 30px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            min-height: 50px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }

        .btn:hover {
            background: #5a9f68;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(103, 178, 121, 0.4);
        }

        .btn-secondary {
            background: #6c757d;
        }

        .btn-secondary:hover {
            background: #5a6268;
        }

        .btn-danger {
            background: #dc3545;
        }

        .btn-danger:hover {
            background: #c82333;
        }

        /* ãƒ¡ã‚¤ãƒ³ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚¨ãƒªã‚¢ */
        .preview-area {
            display: grid;
            grid-template-columns: 1fr;
            gap: 2rem;
        }

        .document-preview {
            background: white;
            border-radius: 15px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .document-header {
            background: linear-gradient(135deg, #ffeaa7 0%, #fab1a0 100%);
            padding: 1.5rem;
            border-bottom: 1px solid #ddd;
        }

        .document-title {
            font-size: 1.8rem;
            font-weight: 700;
            color: #444;
            margin-bottom: 0.5rem;
        }

        .document-meta {
            font-size: 1rem;
            color: #666;
        }

        .document-content {
            padding: 2rem;
        }

        /* ç·¨é›†å¯èƒ½ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ */
        .editable-field {
            background: #f8f9fa;
            border: 2px dashed #ddd;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 8px;
            transition: all 0.3s ease;
            cursor: text;
        }

        .editable-field:hover {
            background: #e9ecef;
            border-color: #67b279;
        }

        .editable-field:focus {
            outline: none;
            background: white;
            border-style: solid;
            border-color: #67b279;
            box-shadow: 0 0 10px rgba(103, 178, 121, 0.2);
        }

        .field-label {
            font-weight: 600;
            color: #495057;
            margin-bottom: 0.5rem;
            display: block;
        }

        .field-value {
            min-height: 1.5rem;
            line-height: 1.6;
        }

        /* å¸³ç¥¨ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ */
        .form-template {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 2rem;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
        }

        .form-header {
            text-align: center;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid #67b279;
        }

        .form-title {
            font-size: 2rem;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 0.5rem;
        }

        .form-section {
            margin-bottom: 2rem;
        }

        .section-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: #495057;
            margin-bottom: 1rem;
            padding: 0.5rem 1rem;
            background: #e9ecef;
            border-radius: 5px;
        }

        .form-row {
            display: grid;
            grid-template-columns: 200px 1fr;
            gap: 1rem;
            margin-bottom: 1rem;
            align-items: start;
        }

        .form-label {
            font-weight: 600;
            color: #495057;
            padding-top: 1rem;
        }

        .form-value {
            background: #f8f9fa;
            border: 1px solid #ddd;
            padding: 1rem;
            border-radius: 5px;
            min-height: 3rem;
        }

        /* ä¿å­˜çŠ¶æ…‹ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ */
        .save-indicator {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 1rem 1.5rem;
            border-radius: 25px;
            font-weight: 600;
            font-size: 16px;
            z-index: 1000;
            transition: all 0.3s ease;
        }

        .save-indicator.saving {
            background: #ffc107;
            color: #856404;
        }

        .save-indicator.saved {
            background: #28a745;
            color: white;
        }

        .save-indicator.error {
            background: #dc3545;
            color: white;
        }

        /* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ– */
        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }

            .preview-toolbar {
                flex-direction: column;
                align-items: stretch;
            }

            .toolbar-actions {
                justify-content: center;
            }

            .form-row {
                grid-template-columns: 1fr;
                gap: 0.5rem;
            }

            .form-label {
                padding-top: 0.5rem;
            }
        }
    </style>
</head>
<body>
    <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
    <header class="header">
        <div class="header-content">
            <div class="logo">ğŸŒ¸ æ­©ã¿ã‚µãƒãƒ¼ãƒˆ</div>
            <nav class="nav-links">
                <a href="/" class="nav-link">ãƒ›ãƒ¼ãƒ </a>
                <a href="/workflow" class="nav-link">è¨˜éŒ²ä½œæˆ</a>
                <a href="/preview" class="nav-link">ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</a>
                <a href="/dashboard" class="nav-link">ç®¡ç†ç”»é¢</a>
            </nav>
        </div>
    </header>

    <div class="container">
        <h1 class="page-title">ğŸ“‹ å¸³ç¥¨ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ»ç·¨é›†</h1>
        <p class="page-subtitle">ä½œæˆã•ã‚ŒãŸå¸³ç¥¨ã‚’ç¢ºèªã—ã€å¿…è¦ã«å¿œã˜ã¦ç·¨é›†ã§ãã¾ã™</p>

        <!-- ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ„ãƒ¼ãƒ«ãƒãƒ¼ -->
        <div class="preview-toolbar">
            <div class="document-selector">
                <label for="documentSelect" style="font-weight: 600;">å¸³ç¥¨ã‚’é¸æŠï¼š</label>
                <select id="documentSelect" class="document-select">
                    <option value="individual-support-plan">å€‹åˆ¥æ”¯æ´è¨ˆç”»æ›¸</option>
                    <option value="monitoring-record">ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°è¨˜éŒ²</option>
                    <option value="family-report">å®¶æ—å ±å‘Šæ›¸</option>
                    <option value="service-record">ã‚µãƒ¼ãƒ“ã‚¹æä¾›å®Ÿç¸¾è¨˜éŒ²</option>
                    <option value="assessment-sheet">ã‚¢ã‚»ã‚¹ãƒ¡ãƒ³ãƒˆã‚·ãƒ¼ãƒˆ</option>
                </select>
            </div>

            <div class="toolbar-actions">
                <button class="btn" onclick="saveDocument()">ğŸ’¾ ä¿å­˜</button>
                <button class="btn btn-secondary" onclick="resetDocument()">ğŸ”„ å…ƒã«æˆ»ã™</button>
                <button class="btn btn-danger" onclick="downloadPDF()">ğŸ“¥ PDFå‡ºåŠ›</button>
            </div>
        </div>

        <!-- ãƒ¡ã‚¤ãƒ³ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚¨ãƒªã‚¢ -->
        <div class="preview-area">
            <div class="document-preview">
                <div class="document-header">
                    <h2 class="document-title" id="currentDocumentTitle">å€‹åˆ¥æ”¯æ´è¨ˆç”»æ›¸</h2>
                    <div class="document-meta" id="currentDocumentMeta">
                        ä½œæˆæ—¥: <span id="creationDate">2024å¹´6æœˆ27æ—¥</span> | 
                        åˆ©ç”¨è€…: <span id="userName">ç”°ä¸­èŠ±å­æ§˜</span>
                    </div>
                </div>

                <div class="document-content">
                    <div class="form-template" id="documentTemplate">
                        <!-- å‹•çš„ã«å¸³ç¥¨ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãŒèª­ã¿è¾¼ã¾ã‚Œã¾ã™ -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ä¿å­˜çŠ¶æ…‹ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ -->
    <div class="save-indicator" id="saveIndicator" style="display: none;">
        ä¿å­˜ä¸­...
    </div>

    <script>
        // å¸³ç¥¨ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆå®šç¾©
        const documentTemplates = {
            'individual-support-plan': {
                title: 'å€‹åˆ¥æ”¯æ´è¨ˆç”»æ›¸',
                sections: [
                    {
                        title: 'åŸºæœ¬æƒ…å ±',
                        fields: [
                            { label: 'åˆ©ç”¨è€…å', key: 'user_name', value: 'ç”°ä¸­èŠ±å­' },
                            { label: 'ç”Ÿå¹´æœˆæ—¥', key: 'birth_date', value: '1990å¹´4æœˆ15æ—¥' },
                            { label: 'éšœå®³ç¨®åˆ¥', key: 'disability_type', value: 'çŸ¥çš„éšœå®³' },
                            { label: 'è¨ˆç”»ä½œæˆæ—¥', key: 'plan_date', value: '2024å¹´6æœˆ27æ—¥' }
                        ]
                    },
                    {
                        title: 'ç¾åœ¨ã®çŠ¶æ³',
                        fields: [
                            { label: 'ç”Ÿæ´»çŠ¶æ³', key: 'living_situation', value: 'Excelã®åŸºæœ¬çš„ãªå…¥åŠ›ä½œæ¥­ãŒã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã€é›†ä¸­æ™‚é–“ã‚‚30åˆ†ã‹ã‚‰1æ™‚é–“ã«å»¶é•·ã•ã‚Œã¦ã„ã‚‹ã€‚' },
                            { label: 'èª²é¡Œãƒ»å›°ã‚Šã”ã¨', key: 'challenges', value: 'é›†ä¸­æ™‚é–“ãŒã¾ã çŸ­ãã€1æ™‚é–“ç¨‹åº¦ãŒé™ç•Œã€‚ã‚ˆã‚Šé•·æ™‚é–“ã®ä½œæ¥­ç¶™ç¶šãŒèª²é¡Œã€‚' },
                            { label: 'æœ¬äººã®æ„å‘', key: 'user_wishes', value: 'ãƒ‘ã‚½ã‚³ãƒ³ä½œæ¥­ã®ã‚¹ã‚­ãƒ«ã‚’å‘ä¸Šã•ã›ã€å°†æ¥çš„ã«ä¸€èˆ¬å°±åŠ´ã‚’ç›®æŒ‡ã—ãŸã„ã€‚' }
                        ]
                    },
                    {
                        title: 'æ”¯æ´ç›®æ¨™',
                        fields: [
                            { label: 'é•·æœŸç›®æ¨™', key: 'long_term_goals', value: 'ä¸€èˆ¬ä¼æ¥­ã§ã®äº‹å‹™è·ã§ã®å°±åŠ´ã‚’ç›®æŒ‡ã™' },
                            { label: 'çŸ­æœŸç›®æ¨™', key: 'short_term_goals', value: 'Excelé–¢æ•°ã‚’ä½¿ã£ãŸè¨ˆç®—æ¥­å‹™ã«æŒ‘æˆ¦ã—ã€é›†ä¸­æ™‚é–“ã‚’1.5æ™‚é–“ã¾ã§å»¶é•·ã™ã‚‹' },
                            { label: 'è©•ä¾¡åŸºæº–', key: 'evaluation_criteria', value: 'é–¢æ•°ã‚’ä½¿ã£ãŸè¨ˆç®—ä½œæ¥­ã®æ­£ç¢ºæ€§ã¨ã€1.5æ™‚é–“ã®ç¶™ç¶šä½œæ¥­é”æˆåº¦' }
                        ]
                    },
                    {
                        title: 'æ”¯æ´å†…å®¹',
                        fields: [
                            { label: 'å…·ä½“çš„æ”¯æ´æ–¹æ³•', key: 'support_methods', value: 'Excelé–¢æ•°ã®æ®µéšçš„æŒ‡å°ã€ä¼‘æ†©ã‚’æŒŸã‚“ã é›†ä¸­åŠ›å‘ä¸Šè¨“ç·´ã€ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚¹ã‚­ãƒ«è¨“ç·´' },
                            { label: 'æ”¯æ´é »åº¦', key: 'support_frequency', value: 'é€±3å›ã€å„2æ™‚é–“' },
                            { label: 'æ‹…å½“è€…', key: 'staff_in_charge', value: 'å°±åŠ´æ”¯æ´å“¡ï¼šå±±ç”°å¤ªéƒ' }
                        ]
                    }
                ]
            },
            'monitoring-record': {
                title: 'ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°è¨˜éŒ²',
                sections: [
                    {
                        title: 'ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°æƒ…å ±',
                        fields: [
                            { label: 'ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°æœŸé–“', key: 'monitoring_period', value: '2024å¹´4æœˆã€œ2024å¹´6æœˆ' },
                            { label: 'å®Ÿæ–½æ—¥', key: 'implementation_date', value: '2024å¹´6æœˆ27æ—¥' },
                            { label: 'å‚åŠ è€…', key: 'participants', value: 'åˆ©ç”¨è€…ï¼šç”°ä¸­èŠ±å­æ§˜ã€æ”¯æ´å“¡ï¼šå±±ç”°å¤ªéƒ' }
                        ]
                    },
                    {
                        title: 'ç›®æ¨™é”æˆçŠ¶æ³',
                        fields: [
                            { label: 'çŸ­æœŸç›®æ¨™ã®é”æˆåº¦', key: 'short_term_achievement', value: 'ExcelåŸºæœ¬æ“ä½œï¼šé”æˆï¼ˆ100%ï¼‰ã€é›†ä¸­æ™‚é–“å»¶é•·ï¼šéƒ¨åˆ†é”æˆï¼ˆ60%ï¼‰' },
                            { label: 'é•·æœŸç›®æ¨™ã¸ã®é€²æ—', key: 'long_term_progress', value: 'å°±åŠ´ç§»è¡Œæ”¯æ´åˆ©ç”¨é–‹å§‹ã‹ã‚‰6ãƒ¶æœˆã€ç€å®Ÿã«ã‚¹ã‚­ãƒ«å‘ä¸Šä¸­' },
                            { label: 'æ–°ãŸãªèª²é¡Œ', key: 'new_challenges', value: 'ã‚ˆã‚Šè¤‡é›‘ãªä½œæ¥­ã¸ã®æŒ‘æˆ¦ã€ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚¹ã‚­ãƒ«ã®å‘ä¸Š' }
                        ]
                    },
                    {
                        title: 'ä»Šå¾Œã®è¨ˆç”»',
                        fields: [
                            { label: 'æ¬¡ã®ç›®æ¨™è¨­å®š', key: 'next_goals', value: 'Excelé–¢æ•°ç¿’å¾—ã€é›†ä¸­æ™‚é–“1.5æ™‚é–“é”æˆã€è·å ´å®Ÿç¿’å‚åŠ ' },
                            { label: 'æ”¯æ´æ–¹é‡ã®å¤‰æ›´', key: 'support_changes', value: 'å€‹åˆ¥æŒ‡å°ã®æ™‚é–“ã‚’å¢—ã‚„ã—ã€å®Ÿè·µçš„ãªèª²é¡Œã«å–ã‚Šçµ„ã‚€' },
                            { label: 'æ¬¡å›ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°äºˆå®š', key: 'next_monitoring', value: '2024å¹´9æœˆæœ«äºˆå®š' }
                        ]
                    }
                ]
            },
            'family-report': {
                title: 'å®¶æ—å ±å‘Šæ›¸',
                sections: [
                    {
                        title: 'å ±å‘ŠæœŸé–“',
                        fields: [
                            { label: 'å ±å‘ŠæœŸé–“', key: 'report_period', value: '2024å¹´4æœˆã€œ2024å¹´6æœˆ' },
                            { label: 'å ±å‘Šä½œæˆæ—¥', key: 'report_date', value: '2024å¹´6æœˆ27æ—¥' },
                            { label: 'ã”å®¶æ—', key: 'family_members', value: 'ç”°ä¸­èŠ±å­æ§˜ã®ãŠæ¯æ§˜' }
                        ]
                    },
                    {
                        title: 'æ´»å‹•ã®æ§˜å­',
                        fields: [
                            { label: 'ã‚µãƒ¼ãƒ“ã‚¹åˆ©ç”¨çŠ¶æ³', key: 'service_usage', value: 'é€±3å›ã€è¦å‰‡æ­£ã—ãé€šæ‰€ã•ã‚Œã¦ã„ã¾ã™ã€‚é…åˆ»ã‚„æ¬ å¸­ã‚‚ã»ã¨ã‚“ã©ãªãã€æ„æ¬²çš„ã«å–ã‚Šçµ„ã¾ã‚Œã¦ã„ã¾ã™ã€‚' },
                            { label: 'æˆé•·ãƒ»å¤‰åŒ–', key: 'growth_changes', value: 'ãƒ‘ã‚½ã‚³ãƒ³æ“ä½œãŒæ ¼æ®µã«ä¸Šé”ã—ã€è‡ªä¿¡ã‚’æŒã£ã¦ä½œæ¥­ã«å–ã‚Šçµ„ã‚€å§¿ãŒè¦‹ã‚‰ã‚Œã¾ã™ã€‚é›†ä¸­åŠ›ã‚‚å‘ä¸Šã—ã¦ã„ã¾ã™ã€‚' },
                            { label: 'æ—¥å¸¸ç”Ÿæ´»', key: 'daily_life', value: 'è‡ªå®…ã§ã‚‚ç°¡å˜ãªä½œæ¥­ã®ç·´ç¿’ã‚’ç¶™ç¶šã•ã‚Œã€ç”Ÿæ´»ãƒªã‚ºãƒ ã‚‚å®‰å®šã—ã¦ã„ã¾ã™ã€‚' }
                        ]
                    },
                    {
                        title: 'ã”å®¶æ—ã¸ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸',
                        fields: [
                            { label: 'ä»Šæœˆã®é ‘å¼µã‚Š', key: 'monthly_efforts', value: 'èŠ±å­æ§˜ã¯æ¯æ—¥ä¸€ç”Ÿæ‡¸å‘½é ‘å¼µã£ã¦ãŠã‚‰ã‚Œã¾ã™ã€‚ç‰¹ã«Excelæ“ä½œã®ç¿’å¾—ã«ç†±å¿ƒã«å–ã‚Šçµ„ã¾ã‚Œã¦ã„ã¾ã™ã€‚' },
                            { label: 'ã”å®¶æ—ã¸ã®ãŠé¡˜ã„', key: 'family_request', value: 'å¼•ãç¶šãã€ã”å®¶åº­ã§ã®ç·´ç¿’ã¨ã‚µãƒãƒ¼ãƒˆã‚’ãŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚è‡ªä¿¡ã«ã¤ãªãŒã‚‹ãŠå£°ãŒã‘ã‚’ãŠé¡˜ã„ã—ã¾ã™ã€‚' },
                            { label: 'æ¥æœˆã®äºˆå®š', key: 'next_month_plan', value: 'ã‚ˆã‚Šå®Ÿè·µçš„ãªäº‹å‹™ä½œæ¥­ã«ãƒãƒ£ãƒ¬ãƒ³ã‚¸ã—ã€è·å ´å®Ÿç¿’ã®æº–å‚™ã‚’é€²ã‚ã¦ã„ãã¾ã™ã€‚' }
                        ]
                    }
                ]
            },
            'service-record': {
                title: 'ã‚µãƒ¼ãƒ“ã‚¹æä¾›å®Ÿç¸¾è¨˜éŒ²',
                sections: [
                    {
                        title: 'ã‚µãƒ¼ãƒ“ã‚¹åŸºæœ¬æƒ…å ±',
                        fields: [
                            { label: 'ã‚µãƒ¼ãƒ“ã‚¹ç¨®åˆ¥', key: 'service_type', value: 'å°±åŠ´ç§»è¡Œæ”¯æ´' },
                            { label: 'æä¾›æ—¥', key: 'service_date', value: '2024å¹´6æœˆ27æ—¥' },
                            { label: 'åˆ©ç”¨æ™‚é–“', key: 'usage_time', value: '10:00ã€œ15:00ï¼ˆ4æ™‚é–“ï¼‰' },
                            { label: 'æ‹…å½“è·å“¡', key: 'staff_name', value: 'å±±ç”°å¤ªéƒ' }
                        ]
                    },
                    {
                        title: 'æä¾›ã—ãŸã‚µãƒ¼ãƒ“ã‚¹å†…å®¹',
                        fields: [
                            { label: 'ä¸»ãªæ´»å‹•', key: 'main_activities', value: 'Excelé–¢æ•°ã®å­¦ç¿’ã€ãƒ‡ãƒ¼ã‚¿å…¥åŠ›ä½œæ¥­ã€é›†ä¸­åŠ›å‘ä¸Šè¨“ç·´' },
                            { label: 'å€‹åˆ¥æ”¯æ´', key: 'individual_support', value: 'VLOOKUPé–¢æ•°ã®ä½¿ã„æ–¹æŒ‡å°ã€å®Ÿè·µçš„ãªè¨ˆç®—èª²é¡Œã¸ã®å–ã‚Šçµ„ã¿' },
                            { label: 'é›†å›£æ´»å‹•', key: 'group_activities', value: 'ãƒãƒ¼ãƒ ã§ã®è³‡æ–™ä½œæˆã€ç™ºè¡¨ç·´ç¿’' }
                        ]
                    },
                    {
                        title: 'åˆ©ç”¨è€…ã®çŠ¶æ³',
                        fields: [
                            { label: 'å‚åŠ çŠ¶æ³', key: 'participation_status', value: 'ç©æ¥µçš„ã«å‚åŠ ã€é›†ä¸­ã—ã¦å–ã‚Šçµ„ã‚€' },
                            { label: 'ä½“èª¿ãƒ»æ°—åˆ†', key: 'condition_mood', value: 'è‰¯å¥½ã€æ„æ¬²çš„' },
                            { label: 'ç‰¹è¨˜äº‹é …', key: 'special_notes', value: 'æ–°ã—ã„é–¢æ•°ã«ã‚‚æŒ‘æˆ¦çš„ã«å–ã‚Šçµ„ã¿ã€ç†è§£åº¦ãŒé«˜ã„' }
                        ]
                    }
                ]
            },
            'assessment-sheet': {
                title: 'ã‚¢ã‚»ã‚¹ãƒ¡ãƒ³ãƒˆã‚·ãƒ¼ãƒˆ',
                sections: [
                    {
                        title: 'ã‚¢ã‚»ã‚¹ãƒ¡ãƒ³ãƒˆåŸºæœ¬æƒ…å ±',
                        fields: [
                            { label: 'å®Ÿæ–½æ—¥', key: 'assessment_date', value: '2024å¹´6æœˆ27æ—¥' },
                            { label: 'å®Ÿæ–½è€…', key: 'assessor', value: 'å°±åŠ´æ”¯æ´å“¡ï¼šå±±ç”°å¤ªéƒ' },
                            { label: 'ã‚¢ã‚»ã‚¹ãƒ¡ãƒ³ãƒˆç›®çš„', key: 'assessment_purpose', value: '3ãƒ¶æœˆé–“ã®æˆé•·ç¢ºèªã¨æ¬¡æœŸç›®æ¨™è¨­å®š' }
                        ]
                    },
                    {
                        title: 'æ©Ÿèƒ½ãƒ»èƒ½åŠ›è©•ä¾¡',
                        fields: [
                            { label: 'èªçŸ¥æ©Ÿèƒ½', key: 'cognitive_function', value: 'ç†è§£åŠ›ï¼šè‰¯å¥½ã€è¨˜æ†¶åŠ›ï¼šè‰¯å¥½ã€æ³¨æ„åŠ›ï¼šå‘ä¸Šä¸­' },
                            { label: 'ä½œæ¥­èƒ½åŠ›', key: 'work_ability', value: 'ãƒ‘ã‚½ã‚³ãƒ³æ“ä½œï¼šä¸Šé”ã€ç¶™ç¶šæ€§ï¼šå‘ä¸Šã€æ­£ç¢ºæ€§ï¼šè‰¯å¥½' },
                            { label: 'ç¤¾ä¼šæ€§', key: 'social_skills', value: 'ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ï¼šè‰¯å¥½ã€å”èª¿æ€§ï¼šè‰¯å¥½ã€è‡ªä¸»æ€§ï¼šå‘ä¸Š' }
                        ]
                    },
                    {
                        title: 'ç·åˆè©•ä¾¡',
                        fields: [
                            { label: 'å¼·ã¿ãƒ»é•·æ‰€', key: 'strengths', value: 'å­¦ç¿’æ„æ¬²ãŒé«˜ãã€æ–°ã—ã„ã“ã¨ã«ã‚‚ç©æ¥µçš„ã«å–ã‚Šçµ„ã‚€ã€‚è²¬ä»»æ„ŸãŒã‚ã‚‹ã€‚' },
                            { label: 'æ”¹å–„ç‚¹ãƒ»èª²é¡Œ', key: 'improvement_areas', value: 'é›†ä¸­æ™‚é–“ã®å»¶é•·ã€ã‚ˆã‚Šè¤‡é›‘ãªä½œæ¥­ã¸ã®é©å¿œ' },
                            { label: 'æ¨å¥¨äº‹é …', key: 'recommendations', value: 'æ®µéšçš„ãªé›£æ˜“åº¦å‘ä¸Šã€å®Ÿç¿’æ©Ÿä¼šã®æä¾›ã€è‡ªä¿¡å‘ä¸Šã®ã‚µãƒãƒ¼ãƒˆ' }
                        ]
                    }
                ]
            }
        };

        let currentData = {};
        let originalData = {};

        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã®åˆæœŸåŒ–
        document.addEventListener('DOMContentLoaded', function() {
            loadDocument('individual-support-plan');
            
            // å¸³ç¥¨é¸æŠã‚¤ãƒ™ãƒ³ãƒˆ
            document.getElementById('documentSelect').addEventListener('change', function() {
                loadDocument(this.value);
            });
        });

        // å¸³ç¥¨èª­ã¿è¾¼ã¿
        function loadDocument(documentType) {
            const template = documentTemplates[documentType];
            if (!template) return;

            // ã‚¿ã‚¤ãƒˆãƒ«æ›´æ–°
            document.getElementById('currentDocumentTitle').textContent = template.title;
            
            // ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆç”Ÿæˆ
            const templateHtml = generateTemplate(template);
            document.getElementById('documentTemplate').innerHTML = templateHtml;

            // ãƒ‡ãƒ¼ã‚¿åˆæœŸåŒ–
            currentData = {};
            originalData = {};
            template.sections.forEach(section => {
                section.fields.forEach(field => {
                    currentData[field.key] = field.value;
                    originalData[field.key] = field.value;
                });
            });

            // ç·¨é›†ã‚¤ãƒ™ãƒ³ãƒˆè¨­å®š
            setupEditableFields();
        }

        // ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆHTMLç”Ÿæˆ
        function generateTemplate(template) {
            let html = `
                <div class="form-header">
                    <h3 class="form-title">${template.title}</h3>
                    <div class="form-meta">ä½œæˆæ—¥: ${new Date().toLocaleDateString('ja-JP')}</div>
                </div>
            `;

            template.sections.forEach(section => {
                html += `
                    <div class="form-section">
                        <h4 class="section-title">${section.title}</h4>
                `;

                section.fields.forEach(field => {
                    html += `
                        <div class="form-row">
                            <div class="form-label">${field.label}</div>
                            <div class="form-value editable-field" 
                                 contenteditable="true" 
                                 data-key="${field.key}"
                                 data-original="${field.value}">
                                ${field.value}
                            </div>
                        </div>
                    `;
                });

                html += `</div>`;
            });

            return html;
        }

        // ç·¨é›†å¯èƒ½ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®è¨­å®š
        function setupEditableFields() {
            document.querySelectorAll('.editable-field').forEach(field => {
                field.addEventListener('input', function() {
                    const key = this.dataset.key;
                    currentData[key] = this.textContent;
                    showSaveIndicator('saving');
                    
                    // è‡ªå‹•ä¿å­˜ï¼ˆ3ç§’å¾Œï¼‰
                    clearTimeout(window.autoSaveTimeout);
                    window.autoSaveTimeout = setTimeout(() => {
                        autoSave();
                    }, 3000);
                });

                field.addEventListener('blur', function() {
                    autoSave();
                });
            });
        }

        // è‡ªå‹•ä¿å­˜
        function autoSave() {
            // å®Ÿéš›ã®APIã‚³ãƒ¼ãƒ«ã¯ã“ã“ã«å®Ÿè£…
            console.log('Auto-saving data:', currentData);
            showSaveIndicator('saved');
        }

        // ä¿å­˜ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼è¡¨ç¤º
        function showSaveIndicator(status) {
            const indicator = document.getElementById('saveIndicator');
            indicator.style.display = 'block';
            
            indicator.className = `save-indicator ${status}`;
            
            switch(status) {
                case 'saving':
                    indicator.textContent = 'ğŸ’¾ ä¿å­˜ä¸­...';
                    break;
                case 'saved':
                    indicator.textContent = 'âœ… ä¿å­˜å®Œäº†';
                    setTimeout(() => {
                        indicator.style.display = 'none';
                    }, 2000);
                    break;
                case 'error':
                    indicator.textContent = 'âŒ ä¿å­˜ã‚¨ãƒ©ãƒ¼';
                    setTimeout(() => {
                        indicator.style.display = 'none';
                    }, 3000);
                    break;
            }
        }

        // æ‰‹å‹•ä¿å­˜
        function saveDocument() {
            showSaveIndicator('saving');
            
            // å®Ÿéš›ã®APIã‚³ãƒ¼ãƒ«
            fetch('/api/documents/save', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    documentType: document.getElementById('documentSelect').value,
                    data: currentData
                })
            })
            .then(response => response.json())
            .then(data => {
                console.log('Document saved:', data);
                showSaveIndicator('saved');
                originalData = { ...currentData };
            })
            .catch(error => {
                console.error('Save error:', error);
                showSaveIndicator('error');
            });
        }

        // å…ƒã«æˆ»ã™
        function resetDocument() {
            if (confirm('ç·¨é›†ã—ãŸå†…å®¹ã‚’å…ƒã«æˆ»ã—ã¾ã™ã‹ï¼Ÿ')) {
                document.querySelectorAll('.editable-field').forEach(field => {
                    const key = field.dataset.key;
                    if (originalData[key]) {
                        field.textContent = originalData[key];
                        currentData[key] = originalData[key];
                    }
                });
                showSaveIndicator('saved');
            }
        }

        // PDFå‡ºåŠ›
        function downloadPDF() {
            const documentType = document.getElementById('documentSelect').value;
            showSaveIndicator('saving');
            
            fetch('/api/pdf/generate', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    documentType: documentType,
                    data: currentData
                })
            })
            .then(response => response.blob())
            .then(blob => {
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `${documentTemplates[documentType].title}_${new Date().toISOString().split('T')[0]}.pdf`;
                document.body.appendChild(a);
                a.click();
                window.URL.revokeObjectURL(url);
                document.body.removeChild(a);
                showSaveIndicator('saved');
            })
            .catch(error => {
                console.error('PDF generation error:', error);
                showSaveIndicator('error');
            });
        }
    </script>
</body>
</html>